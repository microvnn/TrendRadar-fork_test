# ═══════════════════════════════════════════════════════════════
#                    TrendRadar – File cấu hình
#                      Phiên bản: 2.0.0
# ═══════════════════════════════════════════════════════════════

# Trình chỉnh sửa cấu hình trực quan:
# https://sansan0.github.io/TrendRadar/

# ===============================================================
# 1. Cấu hình cơ bản
# ===============================================================
app:
  # Cấu hình múi giờ (ảnh hưởng tới hiển thị thời gian, lịch chạy, lưu dữ liệu)
  # Múi giờ phổ biến:
  #   - Asia/Shanghai (Giờ Bắc Kinh UTC+8)
  #   - America/New_York (Giờ Mỹ Đông UTC-5/-4)
  #   - Europe/London (Giờ London UTC+0/+1)
  # Danh sách đầy đủ:
  # https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  timezone: "Asia/Saigon"
  show_version_update: true # Hiển thị thông báo cập nhật phiên bản

# ===============================================================
# 1.5 Hệ thống lập lịch – làm gì vào thời điểm nào
#
# Dựa trên timeline.yaml để tự động quyết định:
#   - Khi nào gửi thông báo
#   - Khi nào chạy AI phân tích
#   - Sử dụng chế độ báo cáo nào
#
# Nhanh gọn: chỉ cần chọn preset bên dưới
#
#   always_on       → Luôn hoạt động, có mới là đẩy
#   morning_evening → Đẩy cả ngày + tổng hợp buổi tối (khuyên dùng)
#   office_hours    → Giờ hành chính, cuối tuần linh hoạt
#   night_owl       → Xem nhanh buổi chiều + tổng hợp đêm
#   custom          → Tự định nghĩa (xem timeline.yaml)
#
# Xem chi tiết sơ đồ thời gian tại: config/timeline.yaml
# ===============================================================
schedule:
  enabled: true
  preset: "morning_evening"

# ===============================================================
# 2. Nguồn dữ liệu – Bảng xếp hạng hot
#
# enabled: bật/tắt toàn bộ crawl hot list
# sources: danh sách nền tảng
#   - id: định danh duy nhất (không sửa)
#   - name: tên hiển thị (tuỳ chỉnh)
# ===============================================================
platforms:
  enabled: false
  sources:
    - id: "toutiao"
      name: "今日头条"
    - id: "baidu"
      name: "百度热搜"
    - id: "wallstreetcn-hot"
      name: "华尔街见闻"
    - id: "thepaper"
      name: "澎湃新闻"
    - id: "bilibili-hot-search"
      name: "bilibili 热搜"
    - id: "cls-hot"
      name: "财联社热门"
    - id: "ifeng"
      name: "凤凰网"
    - id: "tieba"
      name: "贴吧"
    - id: "weibo"
      name: "微博"
    - id: "douyin"
      name: "抖音"
    - id: "zhihu"
      name: "知乎"

# ===============================================================
# 3. Nguồn dữ liệu – RSS
#
# Lưu riêng với hot list, hiển thị theo dòng thời gian
# Mỗi feed gồm: id, name, url
# enabled: tuỳ chọn (mặc định true)
# max_age_days: ghi đè cấu hình lọc độ mới toàn cục
# ===============================================================
rss:
  enabled: true

  # Bộ lọc độ mới của bài viết (mặc định toàn cục)
  #
  # Mục đích: tránh đẩy lại bài cũ nhiều lần
  #
  # Cơ chế:
  #   - Bài quá N ngày (theo timezone) → không push
  #   - Bài không có publish time → vẫn giữ
  #
  # ⚠️ Chỉ lọc khi push:
  #    - Dữ liệu vẫn được lưu DB
  #    - AI / MCP vẫn truy cập được
  freshness_filter:
    enabled: true
    max_age_days: 3 # Tuổi bài tối đa (ngày), # 0 = tắt lọc

  # Có thể override cho từng feed
  feeds:
    - id: "vnexpress-news"
      name: "vnexpress News"
      url: "https://vnexpress.net/rss/tin-moi-nhat.rss"

    - id: "vnexpress-thoi-su"
      name: "vnexpress-thoi-su"
      url: "https://vnexpress.net/rss/thoi-su.rss"

    - id: "vnexpress-the-gioi"
      name: "vnexpress-the-gioi"
      url: "https://vnexpress.net/rss/the-gioi.rss"
      enabled: true
    
    - id: "vnexpress-khoa-hoc-cong-nghe"
      name: "vnexpress-khoa-hoc-cong-nghe"
      url: "https://vnexpress.net/rss/khoa-hoc-cong-nghe.rss"
      enabled: true

# ===============================================================
# 4. Chế độ báo cáo
#
# daily        → Tổng hợp cả ngày
# current      → Bảng hot hiện tại
# incremental  → Chỉ khi có nội dung mới
# ===============================================================
report:
  mode: "current"

  display_mode: "keyword" # keyword | platform

  sort_by_position_first: false # true = theo thứ tự keyword.txt

  rank_threshold: 5 # Ngưỡng highlight thứ hạng

  max_news_per_keyword: 0 # 0 = không giới hạn

# ===============================================================
# 5. Kiểm soát nội dung push
# ===============================================================
display:
  # Thứ tự hiển thị các khu vực
  region_order:
    - new_items
    - hotlist
    - rss
    - standalone
    - ai_analysis

  # Bật/tắt từng khu vực
  regions:
    hotlist: true
    new_items: false
    rss: true
    standalone: false
    ai_analysis: true

  # Khu vực hiển thị độc lập (không lọc keyword)
  standalone:
    platforms: ["zhihu", "wallstreetcn-hot"]
    rss_feeds: []
    max_items: 20

# ===============================================================
# 6. Cấu hình thông báo
#
# ⚠️ CẢNH BÁO BẢO MẬT
# Không public webhook
# Khuyến nghị dùng GitHub Secrets
# ===============================================================
notification:
  enabled: true

  channels:
    feishu:
      webhook_url: ""

    dingtalk:
      webhook_url: ""

    wework:
      webhook_url: ""
      msg_type: "markdown"

    telegram:
      bot_token: ""
      chat_id: ""

    email:
      from: ""
      password: ""
      to: ""
      smtp_server: ""
      smtp_port: ""

    ntfy:
      server_url: "https://ntfy.sh"
      topic: ""
      token: ""

    bark:
      url: ""

    slack:
      webhook_url: ""

    generic_webhook:
      webhook_url: ""
      payload_template: ""

# ===============================================================
# 7. Lưu trữ dữ liệu
# ===============================================================
storage:
  backend: "auto"

  formats:
    sqlite: true
    txt: false
    html: true

  local:
    data_dir: "output"
    retention_days: 0

  remote:
    retention_days: 0
    endpoint_url: ""
    bucket_name: ""
    access_key_id: ""
    secret_access_key: ""
    region: ""

  pull:
    enabled: false
    days: 7

# ===============================================================
# 8. Cấu hình AI (dùng chung)
# ===============================================================
ai:
  model: "Qwen/Qwen3-14B-AWQ"
  api_key: "123456"
  api_base: "http://localhost:8808/v1"
  timeout: 120
  temperature: 0.0
  max_tokens: 5000
  num_retries: 1
  fallback_models: []

# ===============================================================
# 9. AI phân tích
# ===============================================================
ai_analysis:
  enabled: true
  language: "Vietnamese"
  prompt_file: "ai_analysis_prompt.txt"
  mode: "follow_report"

  max_news_for_analysis: 150
  include_rss: false
  include_standalone: true
  include_rank_timeline: true

# ===============================================================
# 10. AI dịch
# ===============================================================
ai_translation:
  enabled: false
  language: "Vietnamese"
  prompt_file: "ai_translation_prompt.txt"

# ===============================================================
# 11. Cấu hình nâng cao
# ===============================================================
advanced:
  debug: false

  version_check_url: "https://raw.githubusercontent.com/sansan0/TrendRadar/refs/heads/master/version"
  mcp_version_check_url: "https://raw.githubusercontent.com/sansan0/TrendRadar/refs/heads/master/version_mcp"
  configs_version_check_url: "https://raw.githubusercontent.com/sansan0/TrendRadar/refs/heads/master/version_configs"

  crawler:
    request_interval: 2000
    use_proxy: false
    default_proxy: "http://127.0.0.1:10801"

  rss:
    request_interval: 1000
    timeout: 15
    use_proxy: false
    proxy_url: ""

  weight:
    rank: 0.6
    frequency: 0.3
    hotness: 0.1

  max_accounts_per_channel: 3

  batch_size:
    default: 4000
    dingtalk: 20000
    feishu: 30000
    bark: 4000
    slack: 4000

  batch_send_interval: 3
  feishu_message_separator: "━━━━━━━━━━━━━━━━"
